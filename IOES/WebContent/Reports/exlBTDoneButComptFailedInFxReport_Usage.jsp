<%@taglib uri="http://struts.apache.org/tags-html" prefix="html"%>
<%@taglib uri="http://struts.apache.org/tags-bean" prefix="bean"%>
<%@taglib uri="http://struts.apache.org/tags-logic" prefix="logic"%>
<html:html>
<head>
<%
response.setContentType("application/vnd.ms-excel");
%>
</head>
var isUsage ="<%= request.getAttribute("isUsage") %>";
<body>
<logic:present name="billingTriggerDoneButFailedInFXExcelList" scope="request">
<% response.setHeader("content-Disposition","attachment;filename=BillingTriggerDoneButFailedInFX.xls"); %>
<table width="100%" border="1" cellpadding="0" cellspacing="0">
<tr><logic:equal name="isUsage" value="1"><td colspan="14" align="left" style="font-size:10px"><strong>BILLING TRIGGER DONE BUT FAILED IN FX (USAGE)</strong></td></logic:equal></tr>
<logic:equal name="isUsage" value="1">
<tr><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Logical SI No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Logical Si Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Service Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Line Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Contract Start Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Contract End Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Account Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Credit Period</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Currency</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Legal Entity</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Mode</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Bill Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Bill Format</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Licence Company</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Taxation</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Penelty Clause</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Level</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Level Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Pri Location</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Sec Location</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Po Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Po Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Party</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Party Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Trig Flag</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Pm Prov Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Loc Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Trig Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Child Account Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Child Account Internal No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Child Account Fx Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Orderdate</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Approved Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Order Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Service Order Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Copc Approved Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Bill Trg Create Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Logical Si No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Service Stage</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Order Stage</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Account Mgr</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Project Mgr</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Order Creation Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Customer Service Rfs Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Po Receive Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Po Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Po Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Loc Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Address</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Si Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cancel By</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cancel Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cancel Reason</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Region</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Bandwidth</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Vertical</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Location From</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Location To</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Coll Manager</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Coll Mgr Mail</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Coll Mgr Ph</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Billing Bandwidth</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Demo Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Crm Order Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Service No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Contract Period Mnths</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Commitment Period</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Notice Period</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Period In Month</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Tot Po Amt</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Cust Tot Po Amt</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>M6 Order No</b></td><%--  Manisha : change for usage --%><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Package ID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Package Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component InfoID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component ID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Start Logic</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Start Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component End Logic</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component End Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Start Date Days</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Start Date Months</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>End Date Days</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>End Date Months</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Type</b></td><%--<td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component Cyclic/Non-Cyclic Amount</b></td>--%><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Component FX Instance Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Start Token No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>Start FX Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>End Token No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255" ><b>End FX Status</b></td><%-- Manisha : End --%></tr>
</logic:equal>
<logic:empty name="billingTriggerDoneButFailedInFXExcelList">
<tr><td colspan="14" align="center" style="font-size:10px;color:red;"><strong>No Records Found</strong></td></tr>
</logic:empty>
<logic:notEmpty  name="billingTriggerDoneButFailedInFXExcelList" scope="request"> 					
<logic:iterate id="row" name="billingTriggerDoneButFailedInFXExcelList" indexId="recordId">			
<logic:equal name="isUsage" value="1">
<tr><td><bean:write  name="row" property="orderNumber"/></td><td><bean:write  name="row" property="logicalSINumber"/></td><td><bean:write  name="row" property="customer_logicalSINumber"/></td><td><bean:write  name="row" property="serviceName"/></td><td><bean:write  name="row" property="serviceDetDescription"/></td><td><bean:write  name="row" property="contractStartDate"/></td><td><bean:write  name="row" property="contractEndDate"/></td><td><bean:write  name="row" property="crmAccountNoString"/></td><td><bean:write  name="row" property="creditPeriodName"/></td><td><bean:write  name="row" property="currencyName"/></td><td><bean:write  name="row" property="entity"/></td><td><bean:write  name="row" property="billingMode"/></td><td><bean:write  name="row" property="billingTypeName"/></td><td><bean:write  name="row" property="billingFormatName"/></td><td><bean:write  name="row" property="lcompanyname"/></td><td><bean:write  name="row" property="taxation"/></td><td><bean:write  name="row" property="penaltyClause"/></td><td><bean:write  name="row" property="billingLevelName"/></td><td><bean:write  name="row" property="billingLevelNo"/></td><td><bean:write  name="row" property="primaryLocation"/></td><td><bean:write  name="row" property="secondaryLocation"/></td><td><bean:write  name="row" property="ponum"/></td><td><bean:write  name="row" property="poDate"/></td><td><bean:write  name="row" property="party_no"/></td><td><bean:write  name="row" property="partyName"/></td><td><bean:write  name="row" property="billing_Trigger_Flag"/></td><td><bean:write  name="row" property="LOC_Date"/></td><td><bean:write  name="row" property="locDate"/></td><td><bean:write  name="row" property="billingTriggerDate"/></td><td><bean:write  name="row" property="fx_external_acc_id"/></td><td><bean:write  name="row" property="fx_internal_acc_id"/></td><td><bean:write  name="row" property="childAccountFXSataus"/></td><td><bean:write  name="row" property="orderDate"/></td><td><bean:write  name="row" property="orderApproveDate"/></td><td><bean:write  name="row" property="orderType"/></td><td><bean:write  name="row" property="serviceOrderType"/></td><%-- Service Order Type --%><td><bean:write  name="row" property="copcApproveDate"/></td><td><bean:write  name="row" property="billingTriggerDate"/></td><%-- Bill Trg Create Date --%><td><bean:write  name="row" property="customer_logicalSINumber"/></td><%-- Cust Logical SI NO --%><td><bean:write  name="row" property="serviceStage"/></td><td><bean:write  name="row" property="orderStage"/></td><td><bean:write  name="row" property="accountManager"/></td><td><bean:write  name="row" property="projectManager"/></td><td><bean:write  name="row" property="orderDate"/></td><%-- order creation Date --%><td><bean:write  name="row" property="rfsDate"/></td><%--Customer Service Rfs Date--%><td><bean:write  name="row" property="poRecieveDate"/></td><td><bean:write  name="row" property="custPoDetailNo"/></td><td><bean:write  name="row" property="custPoDate"/></td><td><bean:write  name="row" property="LOC_No"/></td><td><bean:write  name="row" property="billingAddress"/></td><td><bean:write  name="row" property="fxSiId"/></td><td><bean:write  name="row" property="cancelBy"/></td><td><bean:write  name="row" property="canceldate"/></td><td><bean:write  name="row" property="cancelServiceReason"/></td><td><bean:write  name="row" property="regionName"/></td><td><bean:write  name="row" property="bandwaidth"/></td><td><bean:write  name="row" property="verticalDetails"/></td><td><bean:write  name="row" property="toLocation"/></td><td><bean:write  name="row" property="fromLocation"/></td><td><bean:write  name="row" property="coll_Manager"/></td><td><bean:write  name="row" property="coll_Manager_Mail"/></td><td><bean:write  name="row" property="coll_Manager_Phone"/></td><td><bean:write  name="row" property="billing_bandwidth"/></td><td><bean:write  name="row" property="order_type"/></td><td><bean:write  name="row" property="orderNumber"/></td><td><bean:write  name="row" property="serviceId"/></td><td><bean:write  name="row" property="contractPeriod"/></td><td><bean:write  name="row" property="commitmentPeriod"/></td><td><bean:write  name="row" property="noticePeriod"/></td><td><bean:write  name="row" property="contractPeriod"/></td><%-- Period in month --%><td><bean:write  name="row" property="totalPoAmt"/></td><td><bean:write  name="row" property="poAmount"/></td><%--Cust Tot Po Amt--%><td><bean:write  name="row" property="m6OrderNo"/></td><%--M6 Order No	--%><%--  Manisha : changes for Usage --%><td><bean:write  name="row" property="packageID"/></td><td><bean:write  name="row" property="packageName"/></td><td><bean:write  name="row" property="componentInfoID"/></td><td><bean:write  name="row" property="componentID"/></td><td><bean:write  name="row" property="componentName"/></td><td><bean:write  name="row" property="componentDto.componentStatus"/></td><td><bean:write  name="row" property="componentDto.startLogic"/></td><td><bean:write  name="row" property="componentDto.startDate"/></td><td><bean:write  name="row" property="componentDto.endLogic"/></td><td><bean:write  name="row" property="componentDto.end_date"/></td><td><bean:write  name="row" property="startDateDays"/></td><td><bean:write  name="row" property="startDateMonth"/></td><td><bean:write  name="row" property="endDateDays"/></td><td><bean:write  name="row" property="endDateMonth"/></td><td><bean:write  name="row" property="componentDto.componentType"/></td><%--<td><bean:write  name="row" property="componentDto.componentAmount"/></td>--%><td><bean:write  name="row" property="componentDto.componentInstanceID"/></td><td><bean:write  name="row" property="componentDto.fxTokenNo"/></td><td><bean:write  name="row" property="componentDto.fxStartStatus"/></td><td><bean:write  name="row" property="componentDto.endTokenNo"/></td><td><bean:write  name="row" property="componentDto.endFxStatus"/></td><%--  Manisha : End --%></tr>
</logic:equal>
</logic:iterate>		
</logic:notEmpty>
</table>
</logic:present>
</body>
</html:html>