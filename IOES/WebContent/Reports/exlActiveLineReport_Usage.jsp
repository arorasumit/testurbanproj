<%@taglib uri="http://struts.apache.org/tags-html" prefix="html"%>
<%@taglib uri="http://struts.apache.org/tags-bean" prefix="bean"%>
<%@taglib uri="http://struts.apache.org/tags-logic" prefix="logic"%>
<!-- [005] Priya Gupta 28-Jan-2016 Added 3 new columns -->
<!-- [006]   Gunjan Singla    6-May-16   20160418-R1-022266  Added columns in report --!>
<html:html>
<head>
<%
response.setContentType("application/vnd.ms-excel");
%>
</head>
var isUsage ="<%= request.getAttribute("isUsage") %>";
<body>
<logic:present name="orderActiveLineItemsList" scope="request">
<% response.setHeader("content-Disposition","attachment;filename=ActiveLineItemsReport.xls"); %>
<table width="100%" border="1" cellpadding="0" cellspacing="0">
<tr><td colspan="46" align="left" style="font-size:10px"><strong>ACTIVE LINE ITEMS REPORT USAGE</strong></td></tr><tr align="Center"><logic:equal name="isUsage" value="1"><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Logical Circuit Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Cust Logical Si Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Service Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Line Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Account Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Credit Period</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Currency</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Legal Entity</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Mode</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Bill Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Bill Format</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Licence Company</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Taxation</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Tax Exemption Reason</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Level</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Level Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Po Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Po Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Party Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Trig Flag</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Pm Prov Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Loc Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Trig Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Child Account Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Child Account Fx Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Child Account FX Internal No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Orderdate</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Approved Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Copc Approved Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Bill Trg Create Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Product</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Subproduct</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Service Stage</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order Stage</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order Creation Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Customer Service Rfs Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Cust Po Receive Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Cust Po Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Cust Po Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Circuit Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Sub Type</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Opms Account Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Region</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Bandwidth</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Vertical</b></td><td align="center" style="font-size:9
px" bgcolor="#FF9255"><b>Project Mgr</b></td><td align="center" style="font-size:9px" bgcol
or="#FF9255"><b>Account Manager</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Product Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Party Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Location From</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Demo Order</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Location To</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Location From</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Location To</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billling Bandwidth</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Bill Uom</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Minimum Bandwith</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Minimum Bandwith UOM</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Lineitemnumber</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Period In Month</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Tot Po Amt</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Party Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Cust Account Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>M6 Order No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Order Line Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Main Line Item No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Service Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Po Expiry Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Package ID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Package Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component ID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component InfoID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component Type</b></td><%--<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>rental / nrc component amount</b></td>--%><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component Start Logic</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component Start Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component End Logic</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component End Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Start Token No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Component FX Instance Id</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Start FX Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>End FX Status</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ExternalID</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Service Segment</b></td>
<!-- [001] rahul Start  -->
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Charge Redirection LSI</b></td>
<!-- [001] rahul End -->
<%-- [002] Neha Start --%><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Installation From City</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Installation To City</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Installation From State</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Installation To State</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Contact Name</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing Contact Number</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Billing EmailId</b></td><%-- [002] Neha End --%><!-- [200515]satyapan OSP/ISP --><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>OSPTagging Required</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>OSPRegistration No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>OSPRegistration Date</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ISPTagging Required</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ISP Catageory</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ISPLicense No</b></td><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ISPLicense Date</b></td><%-- Neha Start --%><td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Change Order Reason</b></td><td align="center" class='inner col2 head1'  ><b>LD Clause</b></td><%-- Neha End --%>
<!-- [005] Start -->
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>SalesForce Opportunity Number</b></td>
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Network Type</b></td>
<!-- <td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Partner Id</b></td> [006]-->
<!-- [005] End -->
<!-- [006] start -->
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Partner Code</b></td>
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Partner Name</b></td>
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>Field Engineer</b></td>
<!-- [006] end -->
<!-- nancy start -->
<td align="center" style="font-size:9px" bgcolor="#FF9255"><b>ePCN No.</b></td>
<!-- nancy end -->
</logic:equal></tr>
<logic:empty name="orderActiveLineItemsList">
<tr><td colspan="46" align="center" style="font-size:10px;color:red;"><strong>No Records Found</strong></td></tr>
</logic:empty>
<logic:notEmpty  name="orderActiveLineItemsList" scope="request"> 					
<logic:iterate id="row" name="orderActiveLineItemsList" indexId="recordId">
<tr><logic:equal name="isUsage" value="1"><td><bean:write  name="row" property="logicalSINo"/></td><td><bean:write  name="row" property="custSINo"/></td><td><bean:write  name="row" property="serviceName"/></td><td><bean:write  name="row" property="linename"/></td><td><bean:write  name="row" property="accountID"/></td><td><bean:write  name="row" property="creditPeriodName"/></td><td><bean:write  name="row" property="currencyName"/></td><td><bean:write  name="row" property="entity"/></td><td><bean:write  name="row" property="billingMode"/></td><td><bean:write  name="row" property="billingTypeName"/></td><td><bean:write  name="row" property="billingformat"/></td><td><bean:write  name="row" property="licCompanyName"/></td><td><bean:write  name="row" property="taxation"/></td><td><bean:write  name="row" property="taxExemptReasonName"/></td><td><bean:write  name="row" property="billingLevelName"/></td><td><bean:write  name="row" property="billingLevelNo"/></td><td><bean:write  name="row" property="poNumber"/></td><td><bean:write  name="row" property="poDate"/></td><td><bean:write  name="row" property="party_num"/></td><td><bean:write  name="row" property="billingTriggerFlag"/></td><td><bean:write  name="row" property="pm_pro_date"/></td><td><bean:write  name="row" property="locDate"/></td><td><bean:write  name="row" property="billing_trigger_date"/></td><td><bean:write  name="row" property="fx_external_acc_id"/></td><td><bean:write  name="row" property="child_account_creation_status"/></td><td><bean:write  name="row" property="fxInternalId"/></td><td><bean:write  name="row" property="orderDate"/></td><td><bean:write  name="row" property="orderApproveDate"/></td><td><bean:write  name="row" property="orderType"/></td><td><bean:write  name="row" property="copcapprovaldate"/></td><td><bean:write  name="row" property="billingtrigger_createdate"/></td><td><bean:write  name="row" property="productName"/></td><td><bean:write  name="row" property="subProductName"/></td><td><bean:write  name="row" property="serviceStage"/></td><td><bean:write  name="row" property="orderStage"/></td><td><bean:write  name="row" property="orderDate"/></td><td><bean:write  name="row" property="rfsDate"/></td><td><bean:write  name="row" property="poReceiveDate"/></td><td><bean:write  name="row" property="custPoDetailNo"/></td><td><bean:write  name="row" property="custPoDate"/></td><td><bean:write  name="row" property="m6cktid"/></td><td><bean:write  name="row" property="ordersubtype"/></td><td></td><td><bean:write  name="row" property="region"/></td><td><bean:write  name="row" property="bandwaidth"/></td><td><bean:write  name="row" property="vertical"/></td><td><bean:write  name="row" property="projectManager"/></td><td><bean:write  name="row" property="accountManager"/></td><td><bean:write  name="row" property="productName"/></td><td><bean:write  name="row" property="partyName"/></td><td><bean:write  name="row" property="billing_location_from"/></td><td><bean:write  name="row" property="demo"/></td><td><bean:write  name="row" property="billing_location_to"/></td><td><bean:write  name="row" property="fromLocation"/></td><td><bean:write  name="row" property="toLocation"/></td><td><bean:write  name="row" property="billing_bandwidth"/></td><td><bean:write  name="row" property="billing_uom"/></td><td><bean:write  name="row" property="minimum_bandwidth"/></td><td><bean:write  name="row" property="minimum_bandwidth_UOM"/></td><td><bean:write  name="row" property="serviceproductid"/></td><td><bean:write  name="row" property="orderNumber"/></td><td><bean:write  name="row" property="contractPeriod"/></td><td><bean:write  name="row" property="totalPoAmt"/></td><td><bean:write  name="row" property="party_id"/></td><td><bean:write  name="row" property="crmAccountNoString"/></td><td><bean:write  name="row" property="m6OrderNo"/></td><td><bean:write  name="row" property="serviceproductid"/></td><td><bean:write  name="row" property="mainSpid"/></td><td><bean:write  name="row" property="serviceId"/></td><td><bean:write  name="row" property="poExpiryDate"/></td><td><bean:write  name="row" property="packageID"/></td><td><bean:write  name="row" property="packageName"/></td><td><bean:write  name="row" property="componentID"/></td><td><bean:write  name="row" property="componentName"/></td><td><bean:write  name="row" property="componentInfoID"/></td><td><bean:write  name="row" property="componentDto.componentType"/></td><%--<td><bean:write  name="row" property="componentDto.componentAmount"/></td>--%><td><bean:write  name="row" property="componentDto.componentStatus"/></td><td><bean:write  name="row" property="componentDto.startLogic"/></td><td><bean:write  name="row" property="componentDto.startDate"/></td><td><bean:write  name="row" property="componentDto.endLogic"/></td><td><bean:write  name="row" property="componentDto.end_date"/></td><td><bean:write  name="row" property="componentDto.fxTokenNo"/></td><td><bean:write  name="row" property="componentDto.componentInstanceID"/></td><td><bean:write  name="row" property="componentDto.fxStartStatus"/></td><td><bean:write  name="row" property="componentDto.endFxStatus"/></td><td><bean:write  name="row" property="externalId"/></td><td><bean:write  name="row" property="serviceSegment"/></td><%-- [001] rahul Start --%><td><bean:write  name="row" property="chargeRedirectionLSI"/></td><%-- [001] rahul End --%><%-- [002] Neha Start --%><td><bean:write  name="row" property="installationFromCity"/></td><td><bean:write  name="row" property="installationToCity"/></td><td><bean:write  name="row" property="installationFromState"/></td><td><bean:write  name="row" property="installationToState"/></td><td><bean:write  name="row" property="billingContactName"/></td><td><bean:write  name="row" property="billingContactNumber"/></td><td><bean:write  name="row" property="billingEmailId"/></td><%-- [200515] Neha End --%><%--[001]Satyapan OSP/ISP--%><td><bean:write  name="row" property="isOspRequired"/></td><td><bean:write  name="row" property="ospRegistrationNo"/></td><td><bean:write  name="row" property="ospRegistrationDate"/></td><td><bean:write  name="row" property="isIspRequired"/></td><td><bean:write  name="row" property="ispCatageory"/></td><td><bean:write  name="row" property="ispLicenseNo"/></td><td><bean:write  name="row" property="ispLicenseDate"/></td><%-- Neha Start --%><td><bean:write  name="row" property="standardReason"/></td><td><bean:write  name="row" property="ldClause"/></td><%-- Neha End --%><!-- [005] Start --><td><bean:write  name="row" property="salesForceOpportunityNumber"/></td><td><bean:write  name="row" property="networkType"/></td><%-- <td><bean:write  name="row" property="partnerId"/></td> --%><!-- [006] start --><td><bean:write  name="row" property="partnerCode"/></td><td><bean:write  name="row" property="channelPartner"/></td><td><bean:write  name="row" property="fieldEngineer"/></td><!-- [006] end --><!-- NANCY START --><td><bean:write  name="row" property="ePCNNo"/></td><!-- nancy end -->
</logic:equal></tr>
</logic:iterate>		
</logic:notEmpty>
</table>
</logic:present>
</body>
</html:html>